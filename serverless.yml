# Welcome to Serverless!
#
# This file is the main config file for your service.
# It's very minimal at this point and uses default values.
# You can always add more config options for more control.
# We've included some commented out config examples here.
# Just uncomment any of them to get that config option.
#
# For full config options, check the docs:
#    docs.serverless.com
#
# Happy Coding!

service: test-project-sailesh
frameworkVersion: "3"

provider:
  name: aws
  runtime: nodejs20.x
  stage: dev
  region: us-east-1

functions:
  testSaileshLambdaFunction:
    name: handler-function
    handler: handler.handler
    role: arn:aws:iam::287655590105:role/lambda-execution-role 
    runtime: nodejs20.x
    memorySize: 128
    timeout: 30
    events:
      - http:
          path: 'handler.js'
          method: get
    package:
      individually: true
      bucket: my-devops-task-bucket
      artifact: handler.zip



custom:
  stage: "dev"
  ServiceName: "${self:custom.stage}-sls"
  config_file: ${file(./resources_file/config_file/config.yml)}
  VPC_CIDR: ${self:custom.config_file.VPC_CIDR}
  DBMinCapacity: ${self:custom.config_file.DBMinCapacity}
  DBMaxCapacity: ${self:custom.config_file.DBMaxCapacity}
  ImageId: ${self:custom.config_file.ImageId}
  InstanceType: ${self:custom.config_file.InstanceType}
  S3BucketName: ${self:custom.ServiceName}-sailesh-bucket


resources:
  - ${file(./resources_file/vpc.yml)}
  - ${file(./resources_file/api.yml)}
  - ${file(./resources_file/bastionhost.yml)}
  - ${file(./resources_file/cloudfront.yml)}
  - ${file(./resources_file/db.yml)}
  - ${file(./resources_file/rdsproxy.yml)}
  - ${file(./resources_file/s3.yml)}

